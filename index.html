<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fedestream</title>
  <style>
    body { font-family: Arial, sans-serif; background:#141414; color:#fff; text-align:center; }
    header { background:#e50914; padding:20px; font-size:2em; }
    input, button { padding:10px; font-size:1em; border-radius:5px; border:none; margin:5px; }
    input { width:60%; }
    button { background:#e50914; color:#fff; cursor:pointer; }
    .results { margin-top:20px; display:flex; flex-wrap:wrap; justify-content:center; gap:10px; }
    .card { background:#222; padding:10px; border-radius:5px; width:200px; text-align:center; }
    iframe { width:80%; height:500px; border:none; border-radius:8px; margin-top:20px; display:none; }
  </style>
</head>
<body>
  <header>Fedestream</header>
  <input type="text" id="searchInput" placeholder="Cerca un film o serie...">
  <button onclick="search()">Cerca</button>

  <div class="results" id="results"></div>
  <iframe id="player" allowfullscreen></iframe>

  <script>
    async function search() {
      const query = document.getElementById('searchInput').value.trim();
      if(!query) return alert("Inserisci un titolo valido!");

      // Puliamo i risultati precedenti
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';
      document.getElementById('player').style.display = 'none';

      // Chiamata API VixSrc
      try {
        const res = await fetch(`https://vixsrc.to/api/list/movie?lang=it&q=${encodeURIComponent(query)}`);
        const data = await res.json();

        if(data.results.length === 0) {
          resultsDiv.innerHTML = "<p>Nessun risultato trovato</p>";
          return;
        }

        data.results.forEach(item => {
          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <strong>${item.title}</strong><br>
            <img src="${item.poster}" width="150"><br>
            <button onclick="play('${item.id}')">Play</button>
          `;
          resultsDiv.appendChild(card);
        });
      } catch(err) {
        console.error(err);
        alert("Errore nel recupero dei dati!");
      }
    }

    function play(tmdbId) {
      const player = document.getElementById('player');
      player.src = `https://vixsrc.to/movie/${tmdbId}/?autoplay=true&primaryColor=B20710&secondaryColor=170000&lang=it`;
      player.style.display = 'block';
      player.scrollIntoView({behavior:"smooth"});
    }
  </script>
</body>
</html>
